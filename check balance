create table #outPutTable (
總額差異 decimal(18,5) ,
PAY_MER_NO varchar(100) ,
特店應付金額 decimal(18,5) ,
轉帳金額 decimal(18,5) ,
匯款金額 decimal(18,5) ,
遞延付款金額 decimal(18,5) ,
人工退貨扣帳 decimal(18,5) ,
暫不付款扣款金額 decimal(18,5) ,
當日緩帳生效金額 decimal(18,5) ,
當日部份暫不付款生效金額 decimal(18,5) ,
作管費金額 decimal(18,5) ,
緊急撥款扣款金額 decimal(18,5) ,
付款手續費差異金額 decimal(18,5) ,
前期未付今日到期金額 decimal(18,5) ,
人工退貨扣帳還款 decimal(18,5) ,
當日負數金額 decimal(18,5) ,
暫不付款還款金額 decimal(18,5) ,
當日部份暫不付款還款金額 decimal(18,5) ,
紅利金額 decimal(18,5) ,
緊急撥款還款金額 decimal(18,5) ,
異常金額 decimal(18,5) 
)
INSERT into  #outPutTable  EXEC SP_BIL_AP_AR_BALANCE  
select * from #outPutTable
where 總額差異<>0

select 特店應付金額 - 轉帳金額 - 匯款金額 - 遞延付款金額 - 人工退貨扣帳 - 暫不付款扣款金額 - 當日緩帳生效金額
 - 當日部份暫不付款生效金額 - 作管費金額 - 緊急撥款扣款金額 -付款手續費差異金額 
 + 前期未付今日到期金額 + 人工退貨扣帳還款 + 當日負數金額 + 暫不付款還款金額 + 當日部份暫不付款還款金額 
 + 紅利金額 + 緊急撥款還款金額 + 異常金額 總額差異,*
 from #outPutTable

 
